{% extends "layouts/base-responsive.html" %}

{% block title %} Dashboard {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

	<link rel="stylesheet" href="/static/assets/css/dashboard.css">

{% endblock stylesheets %}

{% block content %}

<!-- Define page content -->
<div class="content">
	<div class="page-inner">

		<!-- Breadcrumb -->
		<div class="page-header">
			<h4 class="page-title">Product Timeliness</h4>
			<ul class="breadcrumbs">
				<li class="nav-home">
					<a href="/index.html">
						<i class="flaticon-home"></i>
					</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Quarterly Reports</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Product Timeliness</a>
				</li>
			</ul>
		</div>

		<!-- Collapsible description panel -->
		<div class="row">
			<div class="card-body" style="padding-bottom: 0.0rem !important">
				<div class="flex flex-column faq-section">
					<div class="row">
						<div class="col-md-12">
							<div id="accordion">
								<div class="card">
									<div class="card-header" id="heading-description">
										<h5 class="mb-0" style="color: white">
											<a role="button" data-toggle="collapse" href="#description"
											   aria-expanded="false" aria-controls="description"
											   style="color: white; text-decoration: none">
												&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description
											</a>
										</h5>
									</div>
									<div id="description" class="collapse hide" data-parent="#accordion"
										 aria-labelledby="heading-description">
										<div class="card-body">
											This view provides a summary of the publication timeliness of image products, per each
											Copernicus Sentinel Mission and timeliness type. Percentages indicate the amount of
											products published within a fixed timeliness threshold, specified in the label legend,
											and applicable to the given mission / delivery timeliness type. By default, results are
											referred to the previous completed quarter.
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Restricted Data Timeliness-->
		<!-- Mission Timeliness by Timeliness Type (Gauge charts) -->
		<!-- Row with S1 and S2 Charts -->
		<div class="row">
			{% for mission, timeliness_map in timeliness.items() %}
				<div class="col-md-8">
					<div class="card-header">
							<div class="card-title">{{ mission }}</div>							 
					</div>
					{% for timeliness_type, charts in timeliness_map.items() %}
  						<h4>{{ timeliness_type }}</h4>
						<div class="row">
							{% for key, chart in charts.items() %}
								{# Split chartId to extract timeliness type and optional category #}                            
								<div class="col-md-6">
									<div class="card">
										<div class="card-header">
											<div class="card-title">
												{% if key == "_mission" %}
													{{ mission }} {{ timeliness_type }}
												{% else %}
													{{ key }} {{ timeliness_type }}
												{% endif %}
											</div>
										</div>
										<div class="card-body">
											<div class="chart-container">
												<canvas id="{{ chart.pieId }}" style="height:200px"></canvas>
											</div>
										</div>
									</div>
							{% endfor %}
						</div>
					{% endfor %}
					</div>				
				</div>
			{% endfor %}				
		</div>
	</div>
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

	<script src="/static/assets/js/plugin/chart.js/chart.min.js"></script>
	<script type="text/javascript">
    	window.ssrTimelinessData = {{ timeliness | tojson }};
	</script>
	<script src="/static/assets/js/quarterly-reports/product-timeliness.js"></script>
	<script defer type="text/javascript">productTimeliness.init();</script>

{% endblock javascripts %}
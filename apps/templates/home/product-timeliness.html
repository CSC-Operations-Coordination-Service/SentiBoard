{% extends "layouts/base-responsive.html" %}

{% block title %} Dashboard {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

	<link rel="stylesheet" href="/static/assets/css/dashboard.css">

{% endblock stylesheets %}

{% block content %}

<!-- Define page content -->
<div class="content">
	<div class="page-inner">

		<!-- Breadcrumb -->
		<div class="page-header">
			<h4 class="page-title">Product Timeliness</h4>
			<ul class="breadcrumbs">
				<li class="nav-home">
					<a href="/index.html">
						<i class="flaticon-home"></i>
					</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Quarterly Reports</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Product Timeliness</a>
				</li>
			</ul>
		</div>

		<!-- Collapsible description panel -->
		<div class="row">
			<div class="card-body" style="padding-bottom: 0.0rem !important">
				<div class="flex flex-column faq-section">
					<div class="row">
						<div class="col-md-12">
							<div id="accordion">
								<div class="card">
									<div class="card-header" id="heading-description">
										<h5 class="mb-0" style="color: white">
											<a role="button" data-toggle="collapse" href="#description"
											   aria-expanded="false" aria-controls="description"
											   style="color: white; text-decoration: none">
												&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description
											</a>
										</h5>
									</div>
									<div id="description" class="collapse hide" data-parent="#accordion"
										 aria-labelledby="heading-description">
										<div class="card-body">
											This view provides a summary of the publication timeliness of image products, per each
											Copernicus Sentinel Mission and timeliness type. Percentages indicate the amount of
											products published within a fixed timeliness threshold, specified in the label legend,
											and applicable to the given mission / delivery timeliness type. By default, results are
											referred to the previous completed quarter.
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Restricted Data Timeliness-->
		<!-- Mission Timeliness by Timeliness Type (Gauge charts) -->
		<!-- Row with S1 and S2 Charts -->
		<div class="row">
			<!-- Sentinel-1 -->
			<div class="col-md-8">
				<div class="card-header">
					<div class="card-title">Sentinel-1</div>
				</div>

				<div class="row">
					{% for timeliness_type, charts in timeliness["S1"].items() %}
					{% for key, chart in charts.items() %}
						<div class="col-md-6">
						<div class="card mb-3">
							<div class="card-header">
							<div class="card-title">
								Sentinel-1 {{ timeliness_type }}
							</div>
							</div>
							<div class="card-body">
							<canvas id="{{ chart.pieId }}" class="canvasBox"></canvas>
							</div>
						</div>
						</div>
					{% endfor %}
					{% endfor %}
				</div>
			</div>

			<!-- Sentinel-2 -->
			<!-- Sentinel-2 -->
			<div class="col-md-4">
				<div class="card-header">
					<div class="card-title">Sentinel-2</div>
				</div>

				{% for timeliness_type, charts in timeliness["S2"].items() %}
					{% for key, chart in charts.items() %}
					{% if key == "_mission" %}
						<div class="card mb-3">
						<div class="card-header">
							<div class="card-title">
							Sentinel-2 {{ timeliness_type }}
							</div>
						</div>
						<div class="card-body">
							<canvas id="{{ chart.pieId }}" class="canvasBox"></canvas>
						</div>
						</div>
					{% endif %}
					{% endfor %}
				{% endfor %}
			</div>

		</div>
		<div class="row">
			<div class="col-md-12">
				<div class="card-header">
				<div class="card-title">Sentinel-3 NRT</div>
				</div>

				<div class="row">
				{% for key, chart in timeliness["S3"]["NRT"].items() %}
					{% if key != "_mission" %}
					<div class="col-md-4">
						<div class="card mb-3">
						<div class="card-header">
							<div class="card-title">{{ key }} NRT</div>
						</div>
						<div class="card-body">
							<canvas id="{{ chart.pieId }}"></canvas>
						</div>
						</div>
					</div>
					{% endif %}
				{% endfor %}
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<div class="card-header">
				<div class="card-title">Sentinel-3 STC</div>
				</div>

				<div class="row justify-content-center">
				{% for key, chart in timeliness["S3"]["STC"].items() %}
					{% if key != "_mission" %}
					<div class="col-md-4">
						<div class="card mb-3">
						<div class="card-header">
							<div class="card-title">{{ key }} STC</div>
						</div>
						<div class="card-body">
							<canvas id="{{ chart.pieId }}"></canvas>
						</div>
						</div>
					</div>
					{% endif %}
				{% endfor %}
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<div class="card-header">
				<div class="card-title">Sentinel-3 Default Timeliness</div>
				</div>
				{% for row in timeliness["S3"]["NTC"].items() | rejectattr(0, "equalto", "_mission") | list | batch(3, fill_with=None) %}
				<div class="row">
					{% for item in row %}
					{% if item %}
						{% set key = item[0] %}
						{% set chart = item[1] %}
						<div class="col-md-4">
						<div class="card mb-3">
							<div class="card-header">
							<div class="card-title">{{ key }} Default</div>
							</div>
							<div class="card-body">
							<canvas id="{{ chart.pieId }}"></canvas>
							</div>
						</div>
						</div>
					{% endif %}
					{% endfor %}
				</div>
				{% endfor %}
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<div class="card-header">
					<div class="card-title">Sentinel-5</div>
				</div>
				<div class="row">
					{% if "S5" in timeliness %}
						{% for timeliness_type, charts in timeliness["S5"].items() %}
							{% for pg, chart in charts.items() %}
								<div class="col-md-4">
									<div class="card mb-3">
										<div class="card-header">
											<div class="card-title">
												Sentinel-5 {{ timeliness_type }} {% if pg != "_mission" %}{{ pg }}{% endif %}
											</div>
										</div>
										<div class="card-body">
											<canvas id="{{ chart.pieId }}"></canvas>
										</div>
									</div>
								</div>
							{% endfor %}
						{% endfor %}
					{% endif %}
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

	<script src="/static/assets/js/plugin/chart.js/chart.min.js"></script>
	<script type="text/javascript">
    	window.ssrTimelinessData = {{ timeliness | tojson }};
	</script>
	<script src="/static/assets/js/quarterly-reports/product-timeliness.js"></script>
	<script defer type="text/javascript">productTimeliness.init();</script>

{% endblock javascripts %}
{% extends "layouts/base-responsive.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

	<link rel="stylesheet" href="/static/assets/css/dashboard.css">

{% endblock stylesheets %}

{% block content %}

<!-- Define page content -->
<div class="content">
	<div class="page-inner">

		<!-- Breadcrumb -->
		<div class="page-header">
			<h4 class="page-title">Acquisition Service</h4>
			<ul class="breadcrumbs">
				<li class="nav-home">
					<a href="/index.html">
						<i class="flaticon-home"></i>
					</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Quarterly Reports</a>
				</li>
				<li class="separator">
					<i class="flaticon-right-arrow"></i>
				</li>
				<li class="nav-item">
					<a href="#">Acquisition Service</a>
				</li>
			</ul>
		</div>

		<!-- Collapsible description panel -->
		<div class="row">
			<div class="card-body" style="padding-bottom: 0.0rem !important">
				<div class="flex flex-column faq-section">
					<div class="row">
						<div class="col-md-12">
							<div id="accordion">
								<div class="card">
									<div class="card-header" id="heading-description">
										<h5 class="mb-0" style="color: white">
											<a role="button" data-toggle="collapse" href="#description"
											   aria-expanded="false" aria-controls="description"
											   style="color: white; text-decoration: none">
												&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description
											</a>
										</h5>
									</div>
									<div id="description" class="collapse hide" data-parent="#accordion"
										 aria-labelledby="heading-description">
										<div class="card-body">
											This view summarizes the global statistics of the Acquisition Service, in
											the selected time range. The page
											is divided into three main sections: <br>
											- Global acquisitions statistics, considering all stations;<br>
											- Acquisition statistics per Ground Station (the violet boxes);<br>
											- Details on acquisition failures (the pie charts).<br>
											In the Global acquisition statistics, the total number of planned vs
											successful passes is reported. As per the failed passes, according to the
											most recent KPI definition,
											a pass over a stations is deemed as "FAILED" in the event that the ratio of
											error data exceeds 10E-6.
											The possible causes of failures are:
											<br>
											- Acquisition Service problems;<br>
											- Satellite problems;<br>
											- Other issues, such as: interference with other satellites, mission
											planning system errors, bad weather.<br>
											In the Details boxes, the individual problem per each Ground Station is
											reported. Click on a pie chart to display the anomalies responsible for the
											acquisition service failures. By default, results are referred to the
											previous completed quarter.
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Restricted Data -->
		<!-- Global statistics -->
		<div class="row">
			<div class="col-md-6">
				<div class="card card-stats card-round">
					<div class="card-body ">
						<div class="row">
							<div class="col-5">
								<div class="icon-big text-center">
									<i class="flaticon-analytics text-info"></i>
								</div>
							</div>
							<div class="col-7 col-stats">
								<div class="numbers">
									<p class="card-category">Total planned acquisitions</p>
									<h4 class="card-title" id="planned-acquisitions-global-box-mod">
										{{ payload.global.planned }}
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6">
				<div class="card card-stats card-round">
					<div class="card-body ">
						<div class="row">
							<div class="col-5">
								<div class="icon-big text-center">
									<i class="flaticon-success text-success"></i>
								</div>
							</div>
							<div class="col-7 col-stats">
								<div class="numbers">
									<p class="card-category">Successful acquisitions</p>
									<h4 class="card-title" id="successful-acquisitions-global-box-mod">
										{{ payload.global.successful }}
										<span>
											({{ payload.global.successful_percentage }}%)
										</span>
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card card-stats card-round">
					<div class="card-body">
						<div class="row">
							<div class="col-5">
								<div class="icon-big text-center">
									<i class="flaticon-error text-danger"></i>
								</div>
							</div>
							<div class="col-7 col-stats">
								<div class="numbers">
									<p class="card-category">Failures due to Satellite issues</p>
									<h4 class="card-title" id="satellite-failures-global-box-mod">
										{{ payload.global.fail_sat }}
										<span>
											({{ payload.global.fail_sat_percentage }}%)
										</span>	
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card card-stats card-round">
					<div class="card-body">
						<div class="row">
							<div class="col-5">
								<div class="icon-big text-center">
									<i class="flaticon-error text-danger"></i>
								</div>
							</div>
							<div class="col-7 col-stats">
								<div class="numbers">
									<p class="card-category">Failures due to Acquisition Service issues</p>
									<h4 class="card-title" id="acquisition-failures-global-box-mod">
										{{ payload.global.fail_acq }}
										<span>
											({{ payload.global.fail_acq_percentage }}%)
										</span>	
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card card-stats card-round">
					<div class="card-body">
						<div class="row">
							<div class="col-5">
								<div class="icon-big text-center">
									<i class="flaticon-error text-danger"></i>
								</div>
							</div>
							<div class="col-7 col-stats">
								<div class="numbers">
									<p class="card-category">Failures due to Other causes (RFI, bad weather, MPS)</p>
									<h4 class="card-title" id="other-failures-global-box-mod">
										{{ payload.global.fail_other }}
										<span>
											({{ payload.global.fail_other_percentage }}%)
										</span>	
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Successful vs failed passes, per station (boxes) -->
		<div class="row">

			<!-- Svalbard -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="svalbard-station-box-mod">
							{{ payload.stations.svalbard.passes }}
						</h1>
						<h5 class="op-8">Successful passes over Svalbard</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="svalbard-station-box-perc-mod">
								{{ payload.stations.svalbard.passes_percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

			<!-- Inuvik -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="inuvik-station-box-mod">
							{{ payload.stations.inuvik.passes }}
						</h1>
						<h5 class="op-8">Successful passes over Inuvik</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="inuvik-station-box-perc-mod">
								{{ payload.stations.inuvik.passes_percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

			<!-- Matera -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="matera-station-box-mod">
							{{ payload.stations.matera.passes }}
						</h1>
						<h5 class="op-8">Successful passes over Matera</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="matera-station-box-perc-mod">
								{{ payload.stations.matera.passes_percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

			<!-- Maspalomas -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="maspalomas-station-box-mod">
							{{ payload.stations.maspalomas.passes }}
						</h1>
						<h5 class="op-8">Successful passes over Maspalomas</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="maspalomas-station-box-perc-mod">
								{{ payload.stations.maspalomas.passes_percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

			<!-- Neustrelitz -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="neustrelitz-station-box-mod">
							{{ payload.stations.neustrelitz.passes }}
						</h1>
						<h5 class="op-8">Successful passes over Neustrelitz</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="neustrelitz-station-box-perc-mod">
								{{ payload.stations.neustrelitz.passes_percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

			<!-- EDRS -->
			<div class="col-md-4">
				<div class="card card-secondary">
					<div class="card-body skew-shadow">
						<h1 id="edrs-box-mod">
							{{ payload.edrs.successful }}
						</h1>
						<h5 class="op-8">Successful passes using EDRS</h5>
						<div class="pull-right">
							<h3 class="fw-bold op-8" id="edrs-box-perc-mod">
								{{ payload.edrs.percentage }}%
							</h3>
						</div>
					</div>
				</div>
			</div>

		</div>

		<!-- Successful vs failed passes, per station (pie charts) -->
		<div class="row">

			<!-- Svalbard -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="card-title ml-3">Svalbard Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('svalbard')"
									   title="Display the Svalbard acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="svalbard-station-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

			<!-- Inuvik -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
						<div class="card-title ml-3">Inuvik Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('inuvik')"
									   title="Display the Inuvik acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="inuvik-station-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

			<!-- Matera -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="card-title ml-3">Matera Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('matera')"
									   title="Display the Matera acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="matera-station-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

			<!-- Maspalomas -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="card-title ml-3">Maspalomas Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('maspalomas')"
									   title="Display the Maspalomas acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="maspalomas-station-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

			<!-- Neustrelitz -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="card-title ml-3">Neustrelitz Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('neustrelitz')"
									   title="Display the Neustrelitz acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="neustrelitz-station-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

			<!-- EDRS -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="card-title ml-3">EDRS Acquisition Service availability</div>
							<i class="la flaticon-search-1 ml-2 mt-1" data-placement="bottom"
									   data-toggle="tooltip" onclick="acquisitionServiceMod.showAcquisitionStatistics('edrs')"
									   title="Display the EDRS acquisitions statistics"></i>
						</div>
					</div>
					<div class="card-body">
						<div class="chart-container">
							<canvas id="edrs-pie-chart-mod" style="width: 50%; height: 50%"></canvas>
						</div>
					</div>
				</div>
			</div>

		</div>

	</div>
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
	<script src="/static/assets/js/plugin/chart.js/chart.min.js"></script>
	<script src="/static/assets/js/quarterly-reports/acquisition-service-mod.js"></script>
	<script id="acquisition-payload" type="application/json">
		{{ payload | tojson}}
	</script>
	<script>
		document.addEventListener('DOMContentLoaded', function(){
			const payloadEl = document.getElementById('acquisition-payload');
			window.ACQUISITION_PAYLOAD = JSON.parse(payloadEl.textContent);

			window.acquisitionServiceMod = new AcquisitionServiceMod();
			window.acquisitionServiceMod.init();
		})
	</script>
{% endblock javascripts %}